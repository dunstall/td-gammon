# Copyright 2021 Andrew Dunstall

import unittest

import numpy as np

from game import board


class TestBoard(unittest.TestCase):
    def test_encode_state_initial_state_white_turn(self):
        b = board.Board()
        state = b.encode_state(0)

        expected = np.array([
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 0.0, 1.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 1.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 1.0, 0.0, 1.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 0.0, 0.0,

            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 0.0, 1.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 1.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 1.0, 0.0, 1.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 0.0, 0.0,

            0.0, 0.0,
            0.0, 0.0,
            1.0, 0.0
        ])

        self.assertTrue((expected == state).all())

    def test_encode_state_initial_state_black_turn(self):
        b = board.Board()
        state = b.encode_state(1)

        expected = np.array([
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 0.0, 1.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 1.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 1.0, 0.0, 1.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 0.0, 0.0,

            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 0.0, 1.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 1.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 1.0, 0.0, 1.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0,            0.0, 1.0, 0.0, 0.0,

            0.0, 0.0,
            0.0, 0.0,
            0.0, 1.0
        ])

        self.assertTrue((expected == state).all())

    def test_encode_point_empty(self):
        self.assertTrue((np.zeros(4) == board.encode_point(0)).all())

    def test_encode_point_blot(self):
        self.assertTrue((np.array([1, 0, 0, 0]) == board.encode_point(1)).all())

    def test_encode_point_made_point(self):
        self.assertTrue((np.array([0, 1, 0, 0]) == board.encode_point(2)).all())

    def test_encode_point_3(self):
        self.assertTrue((np.array([0, 1, 1, 0]) == board.encode_point(3)).all())

    def test_encode_point_4(self):
        self.assertTrue((np.array([0, 1, 0, 0.5]) == board.encode_point(4)).all())

    def test_encode_point_5(self):
        self.assertTrue((np.array([0, 1, 0, 1]) == board.encode_point(5)).all())
